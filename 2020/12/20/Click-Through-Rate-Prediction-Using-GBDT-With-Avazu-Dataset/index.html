<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="msvalidate.01" content="3caebbd6f719430c88b5a8dc11df5a98">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Helvetica:300,300italic,400,400italic,700,700italic|Courier New:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://blog.zhaoyongsheng.com').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"default"},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: true,
    lazyload: true,
    pangu: true,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="In online advertising and online shopping, Click-Through Rate (CTR) is a good metric to evaluate the quality of advertisement recommendation and goods recommendation. CTR prediction is one of the main">
<meta property="og:type" content="article">
<meta property="og:title" content="Click-Through Rate Prediction Using GBDT and Linear Regression with Avazu Dataset">
<meta property="og:url" content="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/index.html">
<meta property="og:site_name" content="Dr. Zhao&#39;s Blog">
<meta property="og:description" content="In online advertising and online shopping, Click-Through Rate (CTR) is a good metric to evaluate the quality of advertisement recommendation and goods recommendation. CTR prediction is one of the main">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/head.png">
<meta property="og:image" content="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/click-distribution.png">
<meta property="og:image" content="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/banner-pos.png">
<meta property="og:image" content="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/site-cate.png">
<meta property="og:image" content="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/app-cate.png">
<meta property="og:image" content="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/device-type.png">
<meta property="og:image" content="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/corr.png">
<meta property="article:published_time" content="2020-12-20T12:12:40.000Z">
<meta property="article:modified_time" content="2020-12-20T12:12:40.000Z">
<meta property="article:author" content="Dr. Zhao">
<meta property="article:tag" content="Deep Learning">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Click-Through Rate(CTR)">
<meta property="article:tag" content="Machine Learning">
<meta property="article:tag" content="Pandas">
<meta property="article:tag" content="Matplotlib">
<meta property="article:tag" content="Seaborn">
<meta property="article:tag" content="XGBoost">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/head.png">

<link rel="canonical" href="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Click-Through Rate Prediction Using GBDT and Linear Regression with Avazu Dataset | Dr. Zhao's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-153610516-2"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-153610516-2');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?01357a85fc2ab892b21c9ec34514f480";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Dr. Zhao's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">Focus on Scientific Research</h1>
      
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Dr. Zhao">
      <meta itemprop="description" content="A technical blog for sharing articles related to Computer Vision, Robotics & Deep Learning.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dr. Zhao's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          Click-Through Rate Prediction Using GBDT and Linear Regression with Avazu Dataset
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-12-20 20:12:40" itemprop="dateCreated datePublished" datetime="2020-12-20T20:12:40+08:00">2020-12-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Deep-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Deep Learning</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Deep-Learning/Click-Through-Rate-Prediction/" itemprop="url" rel="index">
                    <span itemprop="name">Click-Through Rate Prediction</span>
                  </a>
                </span>
            </span>

          
            <span id="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/" class="post-meta-item leancloud_visitors" data-flag-title="Click-Through Rate Prediction Using GBDT and Linear Regression with Avazu Dataset" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/#comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>7.4k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>7 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <html><head></head><body><p>In online advertising and online shopping, Click-Through Rate (CTR) is a good metric to evaluate the quality of advertisement recommendation and goods recommendation. CTR prediction is one of the main challenges in building an intelligent recommendation system. It aims to predict the probability of an customer clicking the recommended items, which helps us to explore the interests of customers and to choose items for an customer from the massive amount of items effectively and usefully. In this article, I will show you how to build a CTR prediction model using machine learning methods and avazu dataset. Python, pandas,matplotlib, seaborn, xgboost, scikit-learning are used in this article.<br>
<span id="more"></span> ### Definition of Click-Through Rate When we visit a shopping application or a news application, we will see lots of commodities or news that those applications recommend to us and we will click some of the presented commodities or news that we are interested to see the detailed information. In the field of recommendation system, the commodities and news are called item and the presented items are defined as exposed items. When a customer visit a application such as amazon, the application will recommend items that the customer may be interested and hope the customer will click more exposed items. More clicked items means the application knows better about the customer's interests and therefore recommends higher quality items.</p>
<p>Usually, we use Click-Through Rate (CTR) to evaluate the performance of a recommendation system. CTR is defined as the ratio between the number of clicked items and exposed items, formulated as Eq. <span class="math inline">\(\eqref{eq1}\)</span> <span class="math display">\[
\begin{equation}
ctr=\frac{n_{clk}}{n_{exp}}
\label{eq1}
\end{equation}
\]</span> ### Introduction of Avazu Dataset <a target="_blank" rel="noopener" href="https://www.kaggle.com/c/avazu-ctr-prediction/overview">Avazu Dataset</a> is a click-through rate prediction competition sponsored by Avazu. * Train Set 10 days of click-through data, ordered chronologically. Non-clicks and clicks are subsampled according to different strategies. * Test Set 1 day of ads to for testing your model predictions. ### Exploratory Data Analysis In this section, I will analyze the correlation of each column of the raw data with respect to the label and visualize the result using pandas, matplotlib and seaborn. * Split Train Set</p>
<p>The train set contains 10 days of click-through data and is a csv file with size as 6.3 Gb. It takes more than 24.0 Gb's memory to load the whole train set using pandas, which requires a higher performance hardware. Therefore, it is better to split the large train set csv file as small ones. </p><figure class="highlight reasonml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#! /usr/bin/Python</span><br><span class="line">import pandas <span class="keyword">as</span> pd</span><br><span class="line">import numpy <span class="keyword">as</span>  np</span><br><span class="line">from matplotlib import pyplot <span class="keyword">as</span> plt</span><br><span class="line">from collections import Counter</span><br><span class="line">import seaborn <span class="keyword">as</span> sns</span><br><span class="line">import json</span><br><span class="line">import datetime</span><br><span class="line">from sklearn import preprocessing</span><br><span class="line">from sklearn.model_selection import StratifiedShuffleSplit</span><br><span class="line">sns.set<span class="literal">()</span></span><br><span class="line"></span><br><span class="line">avazu = pd.read<span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train</span>.<span class="params">csv</span>', <span class="params">nrows</span>=10000000)</span></span><br><span class="line">avazu.<span class="keyword">to</span><span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train_01</span>.<span class="params">csv</span>', <span class="params">header</span>=True, <span class="params">index</span>=False)</span></span><br><span class="line">avazu = pd.read<span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train</span>.<span class="params">csv</span>', <span class="params">skiprows</span>=<span class="params">range</span>(1, 10000000)</span>, nrows=<span class="number">10000000</span>)</span><br><span class="line">avazu.<span class="keyword">to</span><span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train_02</span>.<span class="params">csv</span>', <span class="params">header</span>=True, <span class="params">index</span>=False)</span></span><br><span class="line">avazu = pd.read<span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train</span>.<span class="params">csv</span>', <span class="params">skiprows</span>=<span class="params">range</span>(1, 20000000)</span>, nrows=<span class="number">10000000</span>)</span><br><span class="line">avazu.<span class="keyword">to</span><span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train_03</span>.<span class="params">csv</span>', <span class="params">header</span>=True, <span class="params">index</span>=False)</span></span><br><span class="line">avazu = pd.read<span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train</span>.<span class="params">csv</span>', <span class="params">skiprows</span>=<span class="params">range</span>(1, 30000000)</span>, nrows=<span class="number">10000000</span>)</span><br><span class="line">avazu.<span class="keyword">to</span><span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train_04</span>.<span class="params">csv</span>', <span class="params">header</span>=True, <span class="params">index</span>=False)</span></span><br><span class="line">avazu = pd.read<span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train</span>.<span class="params">csv</span>', <span class="params">skiprows</span>=<span class="params">range</span>(1, 40000000)</span>, nrows=<span class="number">10000000</span>)</span><br><span class="line">avazu.<span class="keyword">to</span><span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train_05</span>.<span class="params">csv</span>', <span class="params">header</span>=True, <span class="params">index</span>=False)</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<pre><code>* skiprows - the index of skip rows, supports scalar or array input
* nrows - the number of rows to load</code></pre>
<ul>
<li>Random Sampling</li>
</ul>
<p>It is more efficient to do exploratory data analysis using a smaller dataset that has same distribution with the raw dataset. We can randomly sample from the raw dataset using <strong>StratifiedShuffleSplit</strong> imported form <strong>sklearn.model_selection</strong>. </p><figure class="highlight routeros"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">avazu = pd.read_csv(<span class="string">'../data/avazu/train_01.csv'</span>)</span><br><span class="line">split = StratifiedShuffleSplit(<span class="attribute">n_splits</span>=1, <span class="attribute">train_size</span>=0.05, <span class="attribute">test_size</span>=0.05, <span class="attribute">random_state</span>=42)</span><br><span class="line"><span class="keyword">for</span> train_index, test_index <span class="keyword">in</span> split.split(avazu, avazu[<span class="string">"click"</span>]):</span><br><span class="line">    strat_train_set = avazu.loc[train_index]</span><br><span class="line">    <span class="built_in">print</span>(strat_train_set.<span class="built_in">info</span>())</span><br><span class="line">    strat_test_set = avazu.loc[test_index]</span><br><span class="line">    <span class="built_in">print</span>(strat_test_set.<span class="built_in">info</span>())</span><br><span class="line">    strat_train_set.to_csv(<span class="string">"../data/train_sample_01.csv"</span>, header = <span class="literal">True</span>, <span class="attribute">index</span>=<span class="literal">False</span>)</span><br></pre></td></tr></tbody></table></figure> * Merge Sampling Merge the sampled data into one file. <figure class="highlight reasonml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">avazu_01 = pd.read<span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train_sample_01</span>.<span class="params">csv</span>')</span></span><br><span class="line">avazu_02 = pd.read<span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train_sample_02</span>.<span class="params">csv</span>')</span></span><br><span class="line">avazu_03 = pd.read<span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train_sample_03</span>.<span class="params">csv</span>')</span></span><br><span class="line">avazu_04 = pd.read<span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">avazu</span><span class="operator">/</span><span class="params">train_sample_04</span>.<span class="params">csv</span>')</span></span><br><span class="line">avazu = avazu_01.append(<span class="literal">[<span class="identifier">avazu_02</span>, <span class="identifier">avazu_03</span>, <span class="identifier">avazu_04</span>]</span>)</span><br><span class="line">avazu.<span class="keyword">to</span><span class="constructor">_csv('..<span class="operator">/</span><span class="params">data</span><span class="operator">/</span><span class="params">train_sample</span>.<span class="params">csv</span>', <span class="params">header</span>=True, <span class="params">index</span>=False)</span></span><br></pre></td></tr></tbody></table></figure> * Basic Info Load the sampled data and print the basic information. <figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">avazu = pd<span class="selector-class">.read_csv</span>(<span class="string">'../data/avazu/train_sample.csv'</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(avazu.head()</span></span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(avazu.info()</span></span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(list(avazu.columns)</span></span>)</span><br></pre></td></tr></tbody></table></figure> <img alt="Head data of the train sample" data-src="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/head.png"> The info of the train sample is shown as follows. <figure class="highlight tap"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;class 'pandas.core.frame.DataFrame'&gt;</span><br><span class="line">RangeIndex:<span class="number"> 2000000 </span>entries,<span class="number"> 0 </span>to 1999999</span><br><span class="line">Data columns (total<span class="number"> 24 </span>columns):</span><br><span class="line"> <span class="comment">#   Column            Dtype  </span></span><br><span class="line">---  ------            -----  </span><br><span class="line"><span class="number"> 0 </span>  id                float64</span><br><span class="line"><span class="number"> 1 </span>  click             int64  </span><br><span class="line"><span class="number"> 2 </span>  hour              int64  </span><br><span class="line"><span class="number"> 3 </span>  C1                int64  </span><br><span class="line"><span class="number"> 4 </span>  banner_pos        int64  </span><br><span class="line"><span class="number"> 5 </span>  site_id           object </span><br><span class="line"><span class="number"> 6 </span>  site_domain       object </span><br><span class="line"><span class="number"> 7 </span>  site_category     object </span><br><span class="line"><span class="number"> 8 </span>  app_id            object </span><br><span class="line"><span class="number"> 9 </span>  app_domain        object </span><br><span class="line"><span class="number"> 10 </span> app_category      object </span><br><span class="line"><span class="number"> 11 </span> device_id         object </span><br><span class="line"><span class="number"> 12 </span> device_ip         object </span><br><span class="line"><span class="number"> 13 </span> device_model      object </span><br><span class="line"><span class="number"> 14 </span> device_type       int64  </span><br><span class="line"><span class="number"> 15 </span> device_conn_type  int64  </span><br><span class="line"><span class="number"> 16 </span> C14               int64  </span><br><span class="line"><span class="number"> 17 </span> C15               int64  </span><br><span class="line"><span class="number"> 18 </span> C16               int64  </span><br><span class="line"><span class="number"> 19 </span> C17               int64  </span><br><span class="line"><span class="number"> 20 </span> C18               int64  </span><br><span class="line"><span class="number"> 21 </span> C19               int64  </span><br><span class="line"><span class="number"> 22 </span> C20               int64  </span><br><span class="line"><span class="number"> 23 </span> C21               int64  </span><br><span class="line">dtypes: float64(1), int64(14), object(9)</span><br><span class="line">memory usage: 366.2+ MB</span><br><span class="line">None</span><br></pre></td></tr></tbody></table></figure> The columns are shown as follows. <figure class="highlight scheme"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">'id</span>', <span class="symbol">'click</span>', <span class="symbol">'hour</span>', <span class="symbol">'C1</span>', <span class="symbol">'banner_pos</span>', <span class="symbol">'site_id</span>', <span class="symbol">'site_domain</span>', <span class="symbol">'site_category</span>', <span class="symbol">'app_id</span>', <span class="symbol">'app_domain</span>', <span class="symbol">'app_category</span>', <span class="symbol">'device_id</span>', <span class="symbol">'device_ip</span>', <span class="symbol">'device_model</span>', <span class="symbol">'device_type</span>', <span class="symbol">'device_conn_type</span>', <span class="symbol">'C14</span>', <span class="symbol">'C15</span>', <span class="symbol">'C16</span>', <span class="symbol">'C17</span>', <span class="symbol">'C18</span>', <span class="symbol">'C19</span>', <span class="symbol">'C20</span>', <span class="symbol">'C21</span>']</span><br></pre></td></tr></tbody></table></figure> The first column is the index, the second column is the label, the third row the time when the record happened, column 3 and 16-23 are categorical features with dtype as int64, column 5-7 are site features, column 8-10 are app features, column 11-15 are device features. * Label Encode of Categorical Features <figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> column <span class="keyword">in</span> <span class="selector-attr">[<span class="string">'C1'</span>, <span class="string">'site_id'</span>, <span class="string">'site_domain'</span>, <span class="string">'site_category'</span>, <span class="string">'app_id'</span>, <span class="string">'app_domain'</span>, <span class="string">'app_category'</span>, <span class="string">'device_id'</span>, <span class="string">'device_ip'</span>, <span class="string">'device_model'</span>]</span>:</span><br><span class="line">    enc = preprocessing<span class="selector-class">.LabelEncoder</span>()</span><br><span class="line">    avazu<span class="selector-attr">[column]</span> = enc<span class="selector-class">.fit_transform</span>(avazu<span class="selector-attr">[column]</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(avazu.info()</span></span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(avazu.head()</span></span>)</span><br></pre></td></tr></tbody></table></figure> * Feature Visualization * Distribution of positive and negative labels <figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns<span class="selector-class">.countplot</span>(x=avazu<span class="selector-attr">[<span class="string">'click'</span>]</span>)</span><br><span class="line">plt<span class="selector-class">.show</span>()</span><br></pre></td></tr></tbody></table></figure> <img alt="Distribution of positive and negative labels" data-src="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/click-distribution.png"> * Distribution of Banner Position and Label <figure class="highlight routeros"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.countplot(<span class="attribute">x</span>=<span class="string">'banner_pos'</span>, <span class="attribute">hue</span>=<span class="string">'click'</span>, <span class="attribute">data</span>=avazu) #广告位置</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure> <img alt="Distribution of banner position with respect to labels" data-src="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/banner-pos.png"> * Distribution of Site Category and Label <figure class="highlight routeros"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.countplot(<span class="attribute">x</span>=<span class="string">'site_category'</span>, <span class="attribute">hue</span>=<span class="string">'click'</span>, <span class="attribute">data</span>=avazu)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure> <img alt="Distribution of site category with respect to labels" data-src="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/site-cate.png"> * Distribution of Application Category and Label <figure class="highlight routeros"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.countplot(<span class="attribute">x</span>=<span class="string">'app_category'</span>, <span class="attribute">hue</span>=<span class="string">'click'</span>, <span class="attribute">data</span>=avazu)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure> <img alt="Distribution of application category with respect to labels" data-src="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/app-cate.png"> * Distribution of Device Type and Label <figure class="highlight haskell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">sns</span>.countplot(x = <span class="string">"device_type"</span>, hue = <span class="string">"click"</span>, <span class="class"><span class="keyword">data</span> = avazu)</span></span><br><span class="line"><span class="title">plt</span>.show()</span><br></pre></td></tr></tbody></table></figure> <img alt="Distribution of device type with respect to labels" data-src="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/device-type.png"> * Covariance of Features <figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">avazu_drop = avazu<span class="selector-class">.drop</span>(<span class="attribute">columns</span>=[<span class="string">'id'</span>])</span><br><span class="line">avazu_corr = avazu_drop<span class="selector-class">.corr</span>()</span><br><span class="line">plt<span class="selector-class">.figure</span>(figsize=(<span class="number">20</span>, <span class="number">18</span>))</span><br><span class="line">sns<span class="selector-class">.heatmap</span>(avazu_corr<span class="selector-class">.abs</span>(), annot=True)</span><br><span class="line">plt<span class="selector-class">.show</span>()</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(avazu_corr[<span class="string">'click'</span>].sort_values(ascending=False)</span></span>)</span><br></pre></td></tr></tbody></table></figure> <img alt="Covariance of Features" data-src="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/corr.png"> As we can see, C1 and devece_type have high correlation with each other, C14 and C17 have high correlation with each other<p></p>
<h3 id="data-preprocess">Data Preprocess</h3>
<h3 id="hyper-parameters-search">Hyper Parameters Search</h3>
<h3 id="feature-selection-using-gbdt">Feature Selection Using GBDT</h3>
<h3 id="linear-regression-model">Linear Regression Model</h3>
</body></html>
    </div>

    
    
    
        <div class="reward-container">
  <div>Please buy me a cup of coffee if this article helps you.</div>
  <button disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="Dr. Zhao WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="Dr. Zhao Alipay">
        <p>Alipay</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Dr. Zhao
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/" title="Click-Through Rate Prediction Using GBDT and Linear Regression with Avazu Dataset">http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/null" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Deep-Learning/" rel="tag"><i class="fa fa-tag"></i> Deep Learning</a>
              <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
              <a href="/tags/Click-Through-Rate-CTR/" rel="tag"><i class="fa fa-tag"></i> Click-Through Rate(CTR)</a>
              <a href="/tags/Machine-Learning/" rel="tag"><i class="fa fa-tag"></i> Machine Learning</a>
              <a href="/tags/Pandas/" rel="tag"><i class="fa fa-tag"></i> Pandas</a>
              <a href="/tags/Matplotlib/" rel="tag"><i class="fa fa-tag"></i> Matplotlib</a>
              <a href="/tags/Seaborn/" rel="tag"><i class="fa fa-tag"></i> Seaborn</a>
              <a href="/tags/XGBoost/" rel="tag"><i class="fa fa-tag"></i> XGBoost</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/12/11/Usage-of-ASUS-RT-AC86U-Firmware-Upgrade-and-Plugin-Installation/" rel="prev" title="Usage of ASUS RT-AC86U - Firmware Upgrade and Plugin Installation">
      <i class="fa fa-chevron-left"></i> Usage of ASUS RT-AC86U - Firmware Upgrade and Plugin Installation
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/02/08/Deploy-A-Django-Application-on-Ubuntu-Using-Apache-and-PostgreSQL/" rel="next" title="Deploy A Django Application on Ubuntu Using Apache and PostgreSQL">
      Deploy A Django Application on Ubuntu Using Apache and PostgreSQL <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="comments"></div>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#data-preprocess"><span class="nav-number">1.</span> <span class="nav-text">Data Preprocess</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hyper-parameters-search"><span class="nav-number">2.</span> <span class="nav-text">Hyper Parameters Search</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#feature-selection-using-gbdt"><span class="nav-number">3.</span> <span class="nav-text">Feature Selection Using GBDT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#linear-regression-model"><span class="nav-number">4.</span> <span class="nav-text">Linear Regression Model</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Dr. Zhao"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Dr. Zhao</p>
  <div class="site-description" itemprop="description">A technical blog for sharing articles related to Computer Vision, Robotics & Deep Learning.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">51</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">56</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">76</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/YoungsonZhao" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;YoungsonZhao" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zhaoyongsheng@zju.edu.cn" title="E-Mail → mailto:zhaoyongsheng@zju.edu.cn" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/yongshengzhao" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;yongshengzhao" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/yourname" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="skype:swardman@126.com?add" title="Skype → skype:swardman@126.com?add" rel="noopener" target="_blank"><i class="fa fa-fw fa-skype"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-fw fa-rss"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/null" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">浙ICP备2023003977号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dr. Zhao</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">Symbols count total: </span>
    <span title="Symbols count total">280k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">Reading time total &asymp;</span>
    <span title="Reading time total">4:14</span>
</div>
  <div class="addthis_inline_share_toolbox">
    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5de3d9a492e22c4b" async="async"></script>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








        
      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/lozad.js/1.9.0/lozad.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>














  

  
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout: 3000,
        priority: true,
        ignores: [uri => uri.includes('#'),uri => uri == 'http://blog.zhaoyongsheng.com/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/',]
      });
      });
  </script>


<script>
NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'n9rtSD8wdvwav5LXeOerMH5C-gzGzoHsz',
    appKey: 'xcMirBCoS6Ecbog1fFmXEwhu',
    placeholder: "You are welcome to leave a comment.",
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: true,
    lang: '' || 'zh-cn',
    path: location.pathname,
    recordIP: false,
    serverURLs: ''
  });
}, window.Valine);
</script>

</body>
</html>

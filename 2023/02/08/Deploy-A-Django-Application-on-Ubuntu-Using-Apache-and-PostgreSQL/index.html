<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="msvalidate.01" content="3caebbd6f719430c88b5a8dc11df5a98">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Helvetica:300,300italic,400,400italic,700,700italic|Courier New:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://blog.zhaoyongsheng.com').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"default"},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: true,
    lazyload: true,
    pangu: true,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="Django is a high-level Python web framework that encourages rapid development and clean, pragmatic design. Built by experienced developers, it takes care of much of the hassle of web development, so y">
<meta property="og:type" content="article">
<meta property="og:title" content="Deploy A Django Application on Ubuntu Using Apache and PostgreSQL">
<meta property="og:url" content="http://blog.zhaoyongsheng.com/2023/02/08/Deploy-A-Django-Application-on-Ubuntu-Using-Apache-and-PostgreSQL/index.html">
<meta property="og:site_name" content="Dr. Zhao&#39;s Blog">
<meta property="og:description" content="Django is a high-level Python web framework that encourages rapid development and clean, pragmatic design. Built by experienced developers, it takes care of much of the hassle of web development, so y">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-02-07T17:51:54.000Z">
<meta property="article:modified_time" content="2023-02-07T17:51:54.000Z">
<meta property="article:author" content="Dr. Zhao">
<meta property="article:tag" content="Ubuntu">
<meta property="article:tag" content="PostgreSQL">
<meta property="article:tag" content="Django">
<meta property="article:tag" content="Apache">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://blog.zhaoyongsheng.com/2023/02/08/Deploy-A-Django-Application-on-Ubuntu-Using-Apache-and-PostgreSQL/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Deploy A Django Application on Ubuntu Using Apache and PostgreSQL | Dr. Zhao's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-153610516-2"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-153610516-2');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?01357a85fc2ab892b21c9ec34514f480";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Dr. Zhao's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">Focus on Scientific Research</h1>
      
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="http://blog.zhaoyongsheng.com/2023/02/08/Deploy-A-Django-Application-on-Ubuntu-Using-Apache-and-PostgreSQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Dr. Zhao">
      <meta itemprop="description" content="A technical blog for sharing articles related to Computer Vision, Robotics & Deep Learning.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dr. Zhao's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          Deploy A Django Application on Ubuntu Using Apache and PostgreSQL
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-02-08 01:51:54" itemprop="dateCreated datePublished" datetime="2023-02-08T01:51:54+08:00">2023-02-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tutorials/" itemprop="url" rel="index">
                    <span itemprop="name">Tutorials</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Ubuntu/" itemprop="url" rel="index">
                    <span itemprop="name">Ubuntu</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tutorials/PostgreSQL/" itemprop="url" rel="index">
                    <span itemprop="name">PostgreSQL</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tutorials/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>
            </span>

          
            <span id="/2023/02/08/Deploy-A-Django-Application-on-Ubuntu-Using-Apache-and-PostgreSQL/" class="post-meta-item leancloud_visitors" data-flag-title="Deploy A Django Application on Ubuntu Using Apache and PostgreSQL" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2023/02/08/Deploy-A-Django-Application-on-Ubuntu-Using-Apache-and-PostgreSQL/#comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2023/02/08/Deploy-A-Django-Application-on-Ubuntu-Using-Apache-and-PostgreSQL/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>12k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>11 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <html><head></head><body><p><a target="_blank" rel="noopener" href="https://www.djangoproject.com/">Django</a> is a high-level Python web framework that encourages rapid development and clean, pragmatic design. Built by experienced developers, it takes care of much of the hassle of web development, so you can focus on writing your app without needing to reinvent the wheel. In this tutorial, I will teach you to install, develop and deploy a web application step by step using Django, Apache and PostgreSQL on Ubuntu 18.04.</p>
<span id="more"></span>
<h2 id="Prerequire-Installation"><a href="#Prerequire-Installation" class="headerlink" title="Prerequire Installation"></a>Prerequire Installation</h2><h3 id="Install-and-Use-Python3-and-Pip3"><a href="#Install-and-Use-Python3-and-Pip3" class="headerlink" title="Install and Use Python3 and Pip3"></a>Install and Use Python3 and Pip3</h3><p>The default python on Ubuntu 18.04 is python2, which will be deprecated in future. Django recommend us to use python3 which we have a better compatibility and performance.</p>
<h5 id="Install-Python3"><a href="#Install-Python3" class="headerlink" title="Install Python3"></a>Install Python3</h5><figure class="highlight routeros"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> update</span><br><span class="line">sudo apt-<span class="built_in">get</span> install python3 libexpat1</span><br></pre></td></tr></tbody></table></figure>
<h5 id="Set-Python3-as-Default-Python"><a href="#Set-Python3-as-Default-Python" class="headerlink" title="Set Python3 as Default Python"></a>Set Python3 as Default Python</h5><figure class="highlight awk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -rf <span class="regexp">/usr/</span>bin/python</span><br><span class="line">ln -s <span class="regexp">/usr/</span>bin<span class="regexp">/python3 /u</span>sr<span class="regexp">/bin/</span>python</span><br></pre></td></tr></tbody></table></figure>
<h5 id="Install-Pip3"><a href="#Install-Pip3" class="headerlink" title="Install Pip3"></a>Install Pip3</h5><figure class="highlight routeros"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="built_in">get</span> install python3-pip</span><br></pre></td></tr></tbody></table></figure>
<h5 id="Set-Pip3-as-Default-Pip"><a href="#Set-Pip3-as-Default-Pip" class="headerlink" title="Set Pip3 as Default Pip"></a>Set Pip3 as Default Pip</h5><figure class="highlight awk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s <span class="regexp">/usr/</span>bin<span class="regexp">/pip3 /u</span>sr<span class="regexp">/bin/</span>pip</span><br><span class="line">pip install --upgrade pip</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Install-Apache-with-mod-wsgi-Module"><a href="#Install-Apache-with-mod-wsgi-Module" class="headerlink" title="Install Apache with mod_wsgi Module"></a>Install Apache with mod_wsgi Module</h3><p>Deploying Django with <a target="_blank" rel="noopener" href="https://httpd.apache.org/">Apache</a> and <a target="_blank" rel="noopener" href="https://modwsgi.readthedocs.io/en/develop/">mod_wsgi</a> is a tried and tested way to get Django into production. mod_wsgi is an Apache module which can host any Python WSGI application, including Django. Django will work with any version of Apache which supports mod_wsgi.</p>
<h4 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h4><figure class="highlight vim"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> install apache2 apache2-utils ssl-cert libapache2-<span class="keyword">mod</span>-wsgi-<span class="keyword">py3</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="Restart"><a href="#Restart" class="headerlink" title="Restart"></a>Restart</h4><figure class="highlight maxima"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">restart</span> apache2</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Install-PostgreSQL"><a href="#Install-PostgreSQL" class="headerlink" title="Install PostgreSQL"></a>Install PostgreSQL</h3><p><a target="_blank" rel="noopener" href="https://www.postgresql.org/">PostgreSQL</a> is an advanced open source relational database. It has a better performance than django’s default database SQLite, therefore here I use PostgreSQL as Django’s database.</p>
<h4 id="Install-1"><a href="#Install-1" class="headerlink" title="Install"></a>Install</h4><figure class="highlight routeros"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> update</span><br><span class="line">sudo apt-<span class="built_in">get</span> install postgresql postgresql-contrib</span><br><span class="line">pip install psycopg2</span><br></pre></td></tr></tbody></table></figure>
<h4 id="Check-Status"><a href="#Check-Status" class="headerlink" title="Check Status"></a>Check Status</h4><figure class="highlight ebnf"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">service postgresql status</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="Django-Installation"><a href="#Django-Installation" class="headerlink" title="Django Installation"></a>Django Installation</h2><p>After finish the installation of python3, pip3, apache and postgresql, we can install django now. The latest version of Django is 4.1, however I install 3.2.13 to avoid compatibility problems and other unpredictable bugs.</p>
<h3 id="Install-Django"><a href="#Install-Django" class="headerlink" title="Install Django"></a><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/4.1/intro/install/">Install Django</a></h3><h4 id="Install-2"><a href="#Install-2" class="headerlink" title="Install"></a>Install</h4><figure class="highlight apache"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">pip</span> install django==<span class="number">3</span>.<span class="number">2</span>.<span class="number">13</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="Verify-Installation"><a href="#Verify-Installation" class="headerlink" title="Verify Installation"></a>Verify Installation</h4><figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python -m django <span class="attr">--version</span></span><br><span class="line">python</span><br><span class="line">import django</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(django.get_version()</span></span>)</span><br></pre></td></tr></tbody></table></figure>
<h4 id="Install-Required-Packages-Optional-you-can-skip-this-step"><a href="#Install-Required-Packages-Optional-you-can-skip-this-step" class="headerlink" title="Install Required Packages (Optional, you can skip this step)"></a>Install Required Packages (Optional, you can skip this step)</h4><h5 id="Install-REST-Framework"><a href="#Install-REST-Framework" class="headerlink" title="Install REST Framework"></a>Install REST Framework</h5><figure class="highlight cmake"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">install</span> djangorestframework</span><br></pre></td></tr></tbody></table></figure>
<h5 id="Install-PhoneNumberField"><a href="#Install-PhoneNumberField" class="headerlink" title="Install PhoneNumberField"></a>Install PhoneNumberField</h5><figure class="highlight cmake"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">install</span> django-phonenumber-field</span><br><span class="line">pip <span class="keyword">install</span> phonenumbers</span><br></pre></td></tr></tbody></table></figure>
<h5 id="Install-Image-API"><a href="#Install-Image-API" class="headerlink" title="Install Image API"></a>Install Image API</h5><figure class="highlight cmake"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">install</span> pillow</span><br><span class="line">pip <span class="keyword">install</span> drf-extra-fields</span><br></pre></td></tr></tbody></table></figure>
<h5 id="Install-cleanup"><a href="#Install-cleanup" class="headerlink" title="Install cleanup"></a>Install cleanup</h5><figure class="highlight mipsasm"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">install </span>django-cleanup</span><br><span class="line"><span class="keyword">INSTALLED_APPS </span>= (</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">'django_cleanup.apps.CleanupConfig'</span>, <span class="comment"># should be placed after your apps</span></span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>
<h2 id="Develop-Django-Application"><a href="#Develop-Django-Application" class="headerlink" title="Develop Django Application"></a>Develop Django Application</h2><h3 id="Create-Project"><a href="#Create-Project" class="headerlink" title="Create Project"></a>Create Project</h3><p>From the command line, cd into a directory where you’d like to store your project, then run the following command:</p>
<figure class="highlight ebnf"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">django-admin startproject mysite</span></span><br></pre></td></tr></tbody></table></figure>
<p>This will create a mysite directory in your current directory.</p>
<figure class="highlight vim"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysite/</span><br><span class="line">    manage.<span class="keyword">py</span></span><br><span class="line">    mysite/</span><br><span class="line">        __init__.<span class="keyword">py</span></span><br><span class="line">        settings.<span class="keyword">py</span></span><br><span class="line">        urls.<span class="keyword">py</span></span><br><span class="line">        asgi.<span class="keyword">py</span></span><br><span class="line">        wsgi.<span class="keyword">py</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="Deploy-Project"><a href="#Deploy-Project" class="headerlink" title="Deploy Project"></a>Deploy Project</h3><h4 id="Run-Server"><a href="#Run-Server" class="headerlink" title="Run Server"></a>Run Server</h4><p>By default, the runserver command starts the development server on the internal IP at port 8000. If you want to change the server’s port, pass it as a command-line argument. For instance, this command starts the server on port 8080:</p>
<figure class="highlight nginx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">python</span> manage.py runserver <span class="number">0.0.0.0:8080</span></span><br></pre></td></tr></tbody></table></figure>
<p>Then we can visit mysite application via <a target="_blank" rel="noopener" href="http://127.0.0.1:8080/">http://127.0.0.1:8080</a>. Note that runserver is only used for django developing and debug.</p>
<h4 id="Open-Port"><a href="#Open-Port" class="headerlink" title="Open Port"></a>Open Port</h4><p>For safety, the port we used may not open by default on Ubuntu 18.04. We can manually open it.</p>
<figure class="highlight apache"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo</span> ufw <span class="literal">allow</span> <span class="number">8080</span></span><br></pre></td></tr></tbody></table></figure>
<p>If the port is already in user, we have to kill it before runserver.</p>
<figure class="highlight apache"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo</span> fuser -k <span class="number">8080</span>/tcp</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Create-App"><a href="#Create-App" class="headerlink" title="Create App"></a>Create App</h3><p>Now that your environment – a “project” – is set up, you’re set to start doing work. Each application you write in Django consists of a Python package that follows a certain convention. Django comes with a utility that automatically generates the basic directory structure of an app, so you can focus on writing code rather than creating directories.</p>
<p>To create your app, make sure you’re in the same directory as manage.py and type this command:</p>
<figure class="highlight ebnf"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">django-admin startapp api</span></span><br></pre></td></tr></tbody></table></figure>
<p>That’ll create a directory api, which is laid out like this:</p>
<figure class="highlight vim"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">api/</span><br><span class="line">    __init__.<span class="keyword">py</span></span><br><span class="line">    admin.<span class="keyword">py</span></span><br><span class="line">    apps.<span class="keyword">py</span></span><br><span class="line">    migrations/</span><br><span class="line">        __init__.<span class="keyword">py</span></span><br><span class="line">    models.<span class="keyword">py</span></span><br><span class="line">    tests.<span class="keyword">py</span></span><br><span class="line">    views.<span class="keyword">py</span></span><br></pre></td></tr></tbody></table></figure>
<p>This directory structure will house the api application.</p>
<h4 id="Install-App"><a href="#Install-App" class="headerlink" title="Install App"></a>Install App</h4><p>After create the api app, we need to install api app to mysite project. Edit the mysite/settings.py file again, and change the INSTALLED_APPS setting to include the string ‘api’. So it’ll look like this:</p>
<figure class="highlight sml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">INSTALLED_APPS</span> = (</span><br><span class="line">    <span class="symbol">'django</span>.contrib.admin',</span><br><span class="line">    <span class="symbol">'django</span>.contrib.auth',</span><br><span class="line">    <span class="symbol">'django</span>.contrib.contenttypes',</span><br><span class="line">    <span class="symbol">'django</span>.contrib.sessions',</span><br><span class="line">    <span class="symbol">'django</span>.contrib.messages',</span><br><span class="line">    <span class="symbol">'django</span>.contrib.staticfiles',</span><br><span class="line">    <span class="symbol">'api'</span>,</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>Difference between project and application in Django<br> An app is a web application that does something – e.g., a blog system, a database of public records or a small poll app. A project is a collection of configuration and apps for a particular website. A project can contain multiple apps. An app can be in multiple projects.</li>
</ul>
<h4 id="Create-Super-User-and-Login"><a href="#Create-Super-User-and-Login" class="headerlink" title="Create Super User and Login"></a>Create Super User and Login</h4><p>We’ll need to create a user who can login to the admin site. Run the following command:</p>
<figure class="highlight vim"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span> manage.<span class="keyword">py</span> createsuperuser</span><br></pre></td></tr></tbody></table></figure>
<p>Input the user name, email address and password, the above command will create a super user for mysite. Then we can login <a target="_blank" rel="noopener" href="http://127.0.0.1:8080/admin/">http://127.0.0.1:8080/admin/</a> as an administrator and manipulate the data defined by Django’s model.</p>
<h4 id="Make-Migrations"><a href="#Make-Migrations" class="headerlink" title="Make Migrations"></a>Make Migrations</h4><p>When we define new models or change the defined models, we need let django known the definitions and changes by the following commands.</p>
<figure class="highlight vim"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span> manage.<span class="keyword">py</span> makemigrations</span><br><span class="line"><span class="keyword">python</span> manage.<span class="keyword">py</span> migrate</span><br></pre></td></tr></tbody></table></figure>
<h2 id="Deploy-Django-Application-Using-Apache2"><a href="#Deploy-Django-Application-Using-Apache2" class="headerlink" title="Deploy Django Application Using Apache2"></a>Deploy Django Application Using Apache2</h2><p>Although we can serve the django application using the command ‘python manage.py runserver 0.0.0.0:8080’, it is not recommended to use this command to deploy Django’s application. Because this command is designed for developing and debug. It’s performance is poor and it will runout the server’s memory when the application is visited in high concurrency. <a target="_blank" rel="noopener" href="https://httpd.apache.org/">Apache</a> is a famous open-source HTTP server for modern operating systems Unix and Windows. The official documents of Django recommends us to use Apache to deploy Django’s application.</p>
<p>There are two points we need to know before we take further steps into apache configuration.</p>
<ul>
<li>configuration files’ path<figure class="highlight awk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="regexp">/etc/</span>apache2/</span><br><span class="line">tree -L <span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>
We should see the following contents:<figure class="highlight stata"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">├── apache2.<span class="keyword">conf</span></span><br><span class="line">├── <span class="keyword">conf</span>-available</span><br><span class="line">├── <span class="keyword">conf</span>-enabled</span><br><span class="line">├── envvars</span><br><span class="line">├── magic</span><br><span class="line">├── mods-available</span><br><span class="line">├── mods-enabled</span><br><span class="line">├── ports.<span class="keyword">conf</span></span><br><span class="line">├── sites-available</span><br><span class="line">└── sites-enabled</span><br></pre></td></tr></tbody></table></figure>
The <strong>apache2.conf</strong> is the apache’s configuration file and the <strong>ports.conf</strong> defines the port that apache listens. The directory <strong>sites-available</strong> contains configurations of sites that apache can serve and the directory <strong>sites-enabled</strong> contains configurations of sites that apache is serving.</li>
<li>log’s path<figure class="highlight stata"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> /<span class="keyword">var</span>/<span class="keyword">log</span>/apache2</span><br><span class="line">tree</span><br></pre></td></tr></tbody></table></figure>
And we will see the following files:<figure class="highlight applescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">├── access.<span class="built_in">log</span></span><br><span class="line">├── <span class="keyword">error</span>.<span class="built_in">log</span></span><br><span class="line">├── other_vhosts_access.<span class="built_in">log</span></span><br></pre></td></tr></tbody></table></figure>
Logs can offer us useful information when there is something wrong during configure apache.</li>
</ul>
<h3 id="Set-Port"><a href="#Set-Port" class="headerlink" title="Set Port"></a>Set Port</h3><p>The default port is <strong>80</strong> for http, but we can use other ports if port <strong>80</strong> is reserved. Open <strong>ports.conf</strong> and listen the port we want to use for Django application.</p>
<figure class="highlight awk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="regexp">/etc/</span>apache2/ports.conf</span><br></pre></td></tr></tbody></table></figure>
<p>And add the following configuration to let apache listen <strong>8080</strong> port.</p>
<figure class="highlight apache"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Listen</span> <span class="number">8080</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="Enable-Rewrite-Module"><a href="#Enable-Rewrite-Module" class="headerlink" title="Enable Rewrite Module"></a>Enable Rewrite Module</h3><p><a target="_blank" rel="noopener" href="https://httpd.apache.org/docs/current/mod/mod_rewrite.html">Rewrite Module</a> is a rule-based rewrite engine and it rewrites the requested URLs by the defined rules using regular-expression parser. Usually, it is used to redirect one URL to another URL. Here will use it to redirect http request to https request, which is more secure. </p>
<figure class="highlight coq"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a2enmod <span class="built_in">rewrite</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="Configure-Site"><a href="#Configure-Site" class="headerlink" title="Configure Site"></a>Configure Site</h3><p>There is a default enabled site defined in <strong>000-default.conf</strong>. Here we edit this site configuration to deploy Django application.</p>
<figure class="highlight gradle"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp <span class="regexp">/etc/</span>apache2<span class="regexp">/sites-available/</span><span class="number">000</span>-<span class="keyword">default</span>.conf <span class="regexp">/etc/</span>apache2<span class="regexp">/sites-available/</span><span class="number">000</span>-<span class="keyword">default</span>.conf.cp</span><br><span class="line">vi <span class="regexp">/etc/</span>apache2<span class="regexp">/sites-available/</span><span class="number">000</span>-<span class="keyword">default</span>.conf</span><br></pre></td></tr></tbody></table></figure>
<p>And replace the default configuration with the following one:</p>
<figure class="highlight gradle"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualHost *:<span class="number">8080</span>&gt;</span><br><span class="line">    # ServerName <span class="number">172.30</span>.<span class="number">92.118</span></span><br><span class="line">    # ServerAlias zhaoyongsheng.com</span><br><span class="line">    # ServerAdmin yongsheng.zhao.csc@gmail.com</span><br><span class="line"></span><br><span class="line">    WSGIScriptAlias <span class="regexp">/ /</span>django<span class="regexp">/servo/</span>servo/wsgi.py</span><br><span class="line"></span><br><span class="line">    ProxyPass <span class="regexp">/media/</span> !</span><br><span class="line">    Alias <span class="regexp">/media/</span> <span class="regexp">/django/m</span>edia/</span><br><span class="line">    ProxyPass <span class="regexp">/static/</span> !</span><br><span class="line">    Alias <span class="regexp">/static/</span> <span class="regexp">/django/</span>servo<span class="regexp">/static/</span></span><br><span class="line"></span><br><span class="line">    &lt;Directory <span class="regexp">/django/m</span>edia&gt;</span><br><span class="line">         Require all granted</span><br><span class="line">    &lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">    &lt;Directory <span class="regexp">/django/</span>servo/<span class="keyword">static</span>&gt;</span><br><span class="line">         Require all granted</span><br><span class="line">    &lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">    # WSGIDaemonProcess blog python-home=<span class="regexp">/home/</span>sammy<span class="regexp">/myproject/my</span>projectenv python-path=<span class="regexp">/home/</span>sammy/myproject</span><br><span class="line">    # WSGIProcessGroup %{GLOBAL}</span><br><span class="line">    # WSGIDaemonProcess ziqiangxuetang.com python-path=<span class="regexp">/home/</span>tu<span class="regexp">/blog:/</span>home<span class="regexp">/tu/</span>.virtualenvs<span class="regexp">/blog/</span>lib<span class="regexp">/python2.7/</span>site-packages</span><br><span class="line">    # WSGIProcessGroup ziqiangxuetang.com</span><br><span class="line">    # WSGIApplicationGroup %{GLOBAL}</span><br><span class="line"></span><br><span class="line">    &lt;Directory <span class="regexp">/django/</span>servo/servo&gt;</span><br><span class="line">            &lt;Files wsgi.py&gt;</span><br><span class="line">                Require all granted</span><br><span class="line">            &lt;/Files&gt;</span><br><span class="line">    &lt;/Directory&gt;</span><br><span class="line">    ErrorLog ${APACHE_LOG_DIR}/error.log</span><br><span class="line">    CustomLog ${APACHE_LOG_DIR}/access.log combined</span><br><span class="line">    # RewriteEngine on</span><br><span class="line">    # RewriteCond   %{HTTPS} !=on </span><br><span class="line">    # RewriteRule   ^(.*)  https:<span class="comment">//%{SERVER_NAME}$1 [L,R]</span></span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>The first bit in the WSGIScriptAlias line is the base URL path you want to serve your application at (/ indicates the root url), and the second is the location of a “WSGI file” . And the <directory> piece ensures that Apache can access your wsgi.py file.</directory></p>
<ul>
<li>** ProxyPass /static/ !** – Do not deal with <strong>/static/</strong> urls, otherwise it will add a <strong>static/</strong> prefix to the url, such as make “static/admin/base.html” as “static/static/admin/base.html”, for more details please visit the <a target="_blank" rel="noopener" href="https://djangodeployment.readthedocs.io/en/latest/05-static-files.html">Static and media files</a></li>
<li><strong>Alias /media/ /django/media/</strong> – Let apache know where the media directory is.</li>
<li><strong>Alias /static/ /django/servo/static/</strong> – Let apache know where the static directory is.<br>The <a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/4.1/howto/deployment/wsgi/modwsgi/">official documents</a> provides more details about how to deploy Django using apache.</li>
</ul>
<h3 id="Config-Apache"><a href="#Config-Apache" class="headerlink" title="Config Apache"></a>Config Apache</h3><p>The apache’s configuration file is in <strong>/etc/apache2/apache2.conf</strong>. Similarly, we had better make a copy of the default <strong>apache2.conf</strong> before modified it.</p>
<figure class="highlight awk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp <span class="regexp">/etc/</span>apache2<span class="regexp">/apache2.conf /</span>etc<span class="regexp">/apache2/</span>apache2.conf.cp</span><br><span class="line">vi <span class="regexp">/etc/</span>apache2/apache2.conf</span><br></pre></td></tr></tbody></table></figure>
<p>Find and edit the following lines:</p>
<figure class="highlight nsis"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="literal">Directory</span> /&gt;</span><br><span class="line"><span class="number">160</span>         Options FollowSymLinks</span><br><span class="line"><span class="number">161</span>         AllowOverride <span class="literal">None</span></span><br><span class="line"><span class="number">162</span>         Require <span class="literal">all</span> granted</span><br><span class="line"><span class="number">163</span> &lt;/<span class="literal">Directory</span>&gt;</span><br><span class="line"><span class="number">164</span> </span><br><span class="line"><span class="number">165</span> &lt;<span class="literal">Directory</span> /usr/share&gt;</span><br><span class="line"><span class="number">166</span>         AllowOverride <span class="literal">None</span></span><br><span class="line"><span class="number">167</span>         Require <span class="literal">all</span> granted</span><br><span class="line"><span class="number">168</span> &lt;/<span class="literal">Directory</span>&gt;</span><br><span class="line"><span class="number">169</span> </span><br><span class="line"><span class="number">170</span> <span class="comment"># &lt;Directory /var/www/&gt;</span></span><br><span class="line"><span class="number">171</span> <span class="comment">#       Options Indexes FollowSymLinks</span></span><br><span class="line"><span class="number">172</span> <span class="comment">#       AllowOverride None</span></span><br><span class="line"><span class="number">173</span> <span class="comment">#       Require all granted</span></span><br><span class="line"><span class="number">174</span> <span class="comment"># &lt;/Directory&gt;</span></span><br><span class="line"><span class="number">175</span> </span><br><span class="line"><span class="number">176</span> <span class="comment">#&lt;Directory /srv/&gt;</span></span><br><span class="line"><span class="number">177</span> <span class="comment">#       Options Indexes FollowSymLinks</span></span><br><span class="line"><span class="number">178</span> <span class="comment">#       AllowOverride None</span></span><br><span class="line"><span class="number">179</span> <span class="comment">#       Require all granted</span></span><br><span class="line"><span class="number">180</span> <span class="comment">#&lt;/Directory&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>Add the following line at the end of the file.</p>
<figure class="highlight awk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WSGIPythonPath <span class="regexp">/django/</span>servo</span><br></pre></td></tr></tbody></table></figure>
<p><strong>WSGIPythonPath</strong> ensures that your project package is available for import on the Python path; in other words, that import servo works.</p>
<h3 id="Close-Debug-Mode-in-Django"><a href="#Close-Debug-Mode-in-Django" class="headerlink" title="Close Debug Mode in Django"></a>Close Debug Mode in Django</h3><p>Django’s debug mode can print logs which is useful for debug, but its performance is poor. Thus we had better close the debug mode before serving it to web.</p>
<figure class="highlight awk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="regexp">/django/</span>servo<span class="regexp">/servo/</span>settings.py</span><br></pre></td></tr></tbody></table></figure>
<p>Find the line <strong>DEBUG = True</strong>, and set it as False.</p>
<figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">DEBUG</span> = <span class="literal">False</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="Change-Owner-of-Django-Directory"><a href="#Change-Owner-of-Django-Directory" class="headerlink" title="Change Owner of Django Directory"></a>Change Owner of Django Directory</h3><p>Generally, the owner of django’s directory is the admin user of the operation system. We must change the owner to apache to let it have full access to Django’s directory. </p>
<figure class="highlight haskell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">cd</span> /</span><br><span class="line"><span class="title">chown</span> -<span class="type">R</span> www-<span class="class"><span class="keyword">data</span>:www-<span class="keyword">data</span> django</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="Restart-Apache"><a href="#Restart-Apache" class="headerlink" title="Restart Apache"></a>Restart Apache</h3><p>Finishing the above steps, restart apache to deploy Django’s application.</p>
<figure class="highlight maxima"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service apache2 <span class="built_in">restart</span></span><br></pre></td></tr></tbody></table></figure>
<p>Now we can visit the Django’s application via http:xxx.xxx.xxx.xxx:8080/admin/. <strong>Congratulations!</strong><br>If there are any problems, feel free to contact me.</p>
<h3 id="Warnings-Errors-And-Solutions"><a href="#Warnings-Errors-And-Solutions" class="headerlink" title="Warnings, Errors And Solutions"></a>Warnings, Errors And Solutions</h3><h4 id="AH00558-apache2-Could-not-reliably-determine-the-server’s-fully-qualified-domain-name-using-172-30-92-119-Set-the-‘ServerName’-directive-globally-to-suppress-this-message"><a href="#AH00558-apache2-Could-not-reliably-determine-the-server’s-fully-qualified-domain-name-using-172-30-92-119-Set-the-‘ServerName’-directive-globally-to-suppress-this-message" class="headerlink" title="AH00558: apache2: Could not reliably determine the server’s fully qualified domain name, using 172.30.92.119. Set the ‘ServerName’ directive globally to suppress this message"></a>AH00558: apache2: Could not reliably determine the server’s fully qualified domain name, using 172.30.92.119. Set the ‘ServerName’ directive globally to suppress this message</h4><p>Apache uses the ServerName directive to map incoming HTTP requests to an IP address or DNS hostname using VirtualHost directives in order to handle requests for multiple sites using a single server. The error message notes that a global ServerName directive should also be set. Doing so will ensure that Apache can gracefully handle incoming requests that do not map to a VirtualHost without generating additional errors.</p>
<p>For maximum compatibility with various Apache configurations, use the value of 127.0.0.1 for your global ServerName directive. You can use a different IP address or DNS name that corresponds to your server’s configuration if you need to, but it is safest to use 127.0.0.1.</p>
<p>Open the <strong>/etc/apache2/apache2.conf</strong> file using vim.</p>
<figure class="highlight awk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="regexp">/etc/</span>apache2/apache2.conf</span><br></pre></td></tr></tbody></table></figure>
<p>And add the following line to the end of the file.</p>
<figure class="highlight vim"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">. . .</span><br><span class="line"># Include the virtual host configurations:</span><br><span class="line">IncludeOptional sites-enabled/*.<span class="keyword">conf</span></span><br><span class="line"></span><br><span class="line"># <span class="keyword">vim</span>: <span class="keyword">syntax</span>=apache <span class="keyword">ts</span>=<span class="number">4</span> <span class="keyword">sw</span>=<span class="number">4</span> <span class="keyword">sts</span>=<span class="number">4</span> sr noet</span><br><span class="line">ServerName <span class="number">127.0</span>.<span class="number">0.1</span></span><br></pre></td></tr></tbody></table></figure>
<p>Then restart apache and the <strong>AH00558</strong> error will disappear.</p>
<h4 id="Authentication-credentials-were-not-provided"><a href="#Authentication-credentials-were-not-provided" class="headerlink" title="Authentication credentials were not provided."></a>Authentication credentials were not provided.</h4><p>The token authentication works well when I run django project using <strong>python manage.py runserver 0.0.0.0:8080</strong>. I met this error when running django project using apache2. Obviously, this error is a privilege problem. Since I deploy django using wsgi module, I can enable <strong>WSGIPassAuthorization</strong> to solve this problem.<br>Open the site configuration file using vim.</p>
<figure class="highlight gradle"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="regexp">/etc/</span>apache2<span class="regexp">/sites-enabled/</span><span class="number">000</span>-<span class="keyword">default</span>.conf</span><br></pre></td></tr></tbody></table></figure>
<p>And put the following line to the file.</p>
<figure class="highlight apache"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">WSGIPassAuthorization</span> <span class="literal">On</span></span><br></pre></td></tr></tbody></table></figure></body></html>
    </div>

    
    
    
        <div class="reward-container">
  <div>Please buy me a cup of coffee if this article helps you.</div>
  <button disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="Dr. Zhao WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="Dr. Zhao Alipay">
        <p>Alipay</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Dr. Zhao
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="http://blog.zhaoyongsheng.com/2023/02/08/Deploy-A-Django-Application-on-Ubuntu-Using-Apache-and-PostgreSQL/" title="Deploy A Django Application on Ubuntu Using Apache and PostgreSQL">http://blog.zhaoyongsheng.com/2023/02/08/Deploy-A-Django-Application-on-Ubuntu-Using-Apache-and-PostgreSQL/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/null" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Ubuntu/" rel="tag"><i class="fa fa-tag"></i> Ubuntu</a>
              <a href="/tags/PostgreSQL/" rel="tag"><i class="fa fa-tag"></i> PostgreSQL</a>
              <a href="/tags/Django/" rel="tag"><i class="fa fa-tag"></i> Django</a>
              <a href="/tags/Apache/" rel="tag"><i class="fa fa-tag"></i> Apache</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/12/20/Click-Through-Rate-Prediction-Using-GBDT-With-Avazu-Dataset/" rel="prev" title="Click-Through Rate Prediction Using GBDT and Linear Regression with Avazu Dataset">
      <i class="fa fa-chevron-left"></i> Click-Through Rate Prediction Using GBDT and Linear Regression with Avazu Dataset
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/02/11/Basic-Usage-of-PostgreSQL/" rel="next" title="Basic Usage of PostgreSQL">
      Basic Usage of PostgreSQL <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="comments"></div>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Prerequire-Installation"><span class="nav-number">1.</span> <span class="nav-text">Prerequire Installation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Install-and-Use-Python3-and-Pip3"><span class="nav-number">1.1.</span> <span class="nav-text">Install and Use Python3 and Pip3</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Install-Python3"><span class="nav-number">1.1.0.1.</span> <span class="nav-text">Install Python3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Set-Python3-as-Default-Python"><span class="nav-number">1.1.0.2.</span> <span class="nav-text">Set Python3 as Default Python</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Install-Pip3"><span class="nav-number">1.1.0.3.</span> <span class="nav-text">Install Pip3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Set-Pip3-as-Default-Pip"><span class="nav-number">1.1.0.4.</span> <span class="nav-text">Set Pip3 as Default Pip</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Install-Apache-with-mod-wsgi-Module"><span class="nav-number">1.2.</span> <span class="nav-text">Install Apache with mod_wsgi Module</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Install"><span class="nav-number">1.2.1.</span> <span class="nav-text">Install</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Restart"><span class="nav-number">1.2.2.</span> <span class="nav-text">Restart</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Install-PostgreSQL"><span class="nav-number">1.3.</span> <span class="nav-text">Install PostgreSQL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Install-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">Install</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Check-Status"><span class="nav-number">1.3.2.</span> <span class="nav-text">Check Status</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Django-Installation"><span class="nav-number">2.</span> <span class="nav-text">Django Installation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Install-Django"><span class="nav-number">2.1.</span> <span class="nav-text">Install Django</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Install-2"><span class="nav-number">2.1.1.</span> <span class="nav-text">Install</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Verify-Installation"><span class="nav-number">2.1.2.</span> <span class="nav-text">Verify Installation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Install-Required-Packages-Optional-you-can-skip-this-step"><span class="nav-number">2.1.3.</span> <span class="nav-text">Install Required Packages (Optional, you can skip this step)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Install-REST-Framework"><span class="nav-number">2.1.3.1.</span> <span class="nav-text">Install REST Framework</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Install-PhoneNumberField"><span class="nav-number">2.1.3.2.</span> <span class="nav-text">Install PhoneNumberField</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Install-Image-API"><span class="nav-number">2.1.3.3.</span> <span class="nav-text">Install Image API</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Install-cleanup"><span class="nav-number">2.1.3.4.</span> <span class="nav-text">Install cleanup</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Develop-Django-Application"><span class="nav-number">3.</span> <span class="nav-text">Develop Django Application</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-Project"><span class="nav-number">3.1.</span> <span class="nav-text">Create Project</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Deploy-Project"><span class="nav-number">3.2.</span> <span class="nav-text">Deploy Project</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Run-Server"><span class="nav-number">3.2.1.</span> <span class="nav-text">Run Server</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Open-Port"><span class="nav-number">3.2.2.</span> <span class="nav-text">Open Port</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-App"><span class="nav-number">3.3.</span> <span class="nav-text">Create App</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Install-App"><span class="nav-number">3.3.1.</span> <span class="nav-text">Install App</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Create-Super-User-and-Login"><span class="nav-number">3.3.2.</span> <span class="nav-text">Create Super User and Login</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Make-Migrations"><span class="nav-number">3.3.3.</span> <span class="nav-text">Make Migrations</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Deploy-Django-Application-Using-Apache2"><span class="nav-number">4.</span> <span class="nav-text">Deploy Django Application Using Apache2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Set-Port"><span class="nav-number">4.1.</span> <span class="nav-text">Set Port</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Enable-Rewrite-Module"><span class="nav-number">4.2.</span> <span class="nav-text">Enable Rewrite Module</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configure-Site"><span class="nav-number">4.3.</span> <span class="nav-text">Configure Site</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Config-Apache"><span class="nav-number">4.4.</span> <span class="nav-text">Config Apache</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Close-Debug-Mode-in-Django"><span class="nav-number">4.5.</span> <span class="nav-text">Close Debug Mode in Django</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Change-Owner-of-Django-Directory"><span class="nav-number">4.6.</span> <span class="nav-text">Change Owner of Django Directory</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Restart-Apache"><span class="nav-number">4.7.</span> <span class="nav-text">Restart Apache</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Warnings-Errors-And-Solutions"><span class="nav-number">4.8.</span> <span class="nav-text">Warnings, Errors And Solutions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#AH00558-apache2-Could-not-reliably-determine-the-server%E2%80%99s-fully-qualified-domain-name-using-172-30-92-119-Set-the-%E2%80%98ServerName%E2%80%99-directive-globally-to-suppress-this-message"><span class="nav-number">4.8.1.</span> <span class="nav-text">AH00558: apache2: Could not reliably determine the server’s fully qualified domain name, using 172.30.92.119. Set the ‘ServerName’ directive globally to suppress this message</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Authentication-credentials-were-not-provided"><span class="nav-number">4.8.2.</span> <span class="nav-text">Authentication credentials were not provided.</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Dr. Zhao"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Dr. Zhao</p>
  <div class="site-description" itemprop="description">A technical blog for sharing articles related to Computer Vision, Robotics & Deep Learning.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">46</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">53</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">72</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/YoungsonZhao" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;YoungsonZhao" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zhaoyongsheng@zju.edu.cn" title="E-Mail → mailto:zhaoyongsheng@zju.edu.cn" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/yongshengzhao" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;yongshengzhao" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/yourname" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="skype:swardman@126.com?add" title="Skype → skype:swardman@126.com?add" rel="noopener" target="_blank"><i class="fa fa-fw fa-skype"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-fw fa-rss"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/null" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">浙ICP备2023003977号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dr. Zhao</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">Symbols count total: </span>
    <span title="Symbols count total">233k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">Reading time total &asymp;</span>
    <span title="Reading time total">3:32</span>
</div>
  <div class="addthis_inline_share_toolbox">
    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5de3d9a492e22c4b" async="async"></script>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








        
      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/lozad.js/1.9.0/lozad.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>














  

  
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout: 3000,
        priority: true,
        ignores: [uri => uri.includes('#'),uri => uri == 'http://blog.zhaoyongsheng.com/2023/02/08/Deploy-A-Django-Application-on-Ubuntu-Using-Apache-and-PostgreSQL/',]
      });
      });
  </script>


<script>
NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'n9rtSD8wdvwav5LXeOerMH5C-gzGzoHsz',
    appKey: 'xcMirBCoS6Ecbog1fFmXEwhu',
    placeholder: "You are welcome to leave a comment.",
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: true,
    lang: '' || 'zh-cn',
    path: location.pathname,
    recordIP: false,
    serverURLs: ''
  });
}, window.Valine);
</script>

</body>
</html>
